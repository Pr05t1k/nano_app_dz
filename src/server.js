const app = require('./app');

const PORT = process.env.PORT || 3000;
const HOST = process.env.HOST || '0.0.0.0';

const server = app.listen(PORT, HOST, () => {
  console.log(`âœ… Notes API Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð½Ð° http://${HOST}:${PORT}`);
  console.log(`ðŸ“Œ Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ñ‹:`);
  console.log(`   http://${HOST}:${PORT}/api/health - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ`);
  console.log(`   http://${HOST}:${PORT}/api/notes  - Ð’ÑÐµ Ð·Ð°Ð¼ÐµÑ‚ÐºÐ¸`);
  console.log(`   GET /api/notes/:id - ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ`);
  console.log(`   POST /api/notes - Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ`);
  console.log(`   PUT /api/notes/:id - ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ`);
  console.log(`   DELETE /api/notes/:id - Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ`);
});

// Graceful shutdown
process.on('SIGTERM', () => {
  console.log('SIGTERM signal received: closing HTTP server');
  server.close(() => {
    console.log('HTTP server closed');
  });
});

module.exports = server;